<form [formGroup]="basicDetailsForm" (ngSubmit)="onSubmit()">
  <div class="row">
    <div class="col-md-2">
      <div class="material-image-upload d-flex flex-column justify-content-center">
        <img src="assets/img/icons/ic_camera.svg" alt="Kamera ikoni">
        <a href="#">{{ 'forms.educationalResource.basicDetails.uploadImage' | translate }}</a>
      </div>
    </div>

    <div class="col-md-10">
      <ng-container *ngFor="let author of authors.controls; let i = index;">
        <div class="form-row" formArrayName="authors">
          <ng-container [formGroupName]="i">
            <div class="form-group col">
              <label for="{{ 'author' + i }}">{{ 'forms.educationalResource.basicDetails.author.inputs.author.label' | translate }}*</label>

              <button
                type="button"
                class="btn btn-link"
                [tooltip]="'forms.educationalResource.basicDetails.author.inputs.author.tooltip' | translate"
              ><img src="assets/img/icons/ic_help.svg" alt=""></button>

              <input
                type="text"
                class="form-control"
                id="{{ 'author' + i }}"
                [placeholder]="'forms.educationalResource.basicDetails.author.inputs.author.placeholder' | translate"
                formControlName="author"
              >
            </div>

            <div class="form-group col">
              <label for="{{ 'organisation ' + i }}">{{ 'forms.educationalResource.basicDetails.author.inputs.organisation.label' | translate }}</label>

              <button
                type="button"
                class="btn btn-link"
                [tooltip]="'forms.educationalResource.basicDetails.author.inputs.organisation.tooltip' | translate"
              ><img src="assets/img/icons/ic_help.svg" alt=""></button>

              <ng-select
                [items]="organisationsBuffer"
                [virtualScroll]="true"
                [loading]="loadingOrganisations"
                [addTag]="addCustomItem"
                bindLabel="value"
                id="{{ 'organisation ' + i }}"
                [typeahead]="organisationsInput$"
                (scrollToEnd)="fetchMoreOrganisations(organisation.filterValue)"
                formControlName="organisation"
                #organisation
              ></ng-select>
            </div>

            <div class="form-group align-self-end col-auto" *ngIf="i !== 0">
              <button type="button" class="btn btn-danger" (click)="removeAuthor(i)">{{ 'forms.common.delete' | translate }}</button>
            </div>
          </ng-container>
        </div>
      </ng-container>

      <div class="form-group">
        <button type="button" class="btn btn-gray" (click)="addAuthor()">Lisää toinen tekijä</button>
      </div>

      <div class="form-group">
        <label for="keywords">{{ 'forms.educationalResource.basicDetails.keywords.label' | translate }}*</label>

        <button
          type="button"
          class="btn btn-link"
          [tooltip]="'forms.educationalResource.basicDetails.keywords.tooltip' | translate"
        ><img src="assets/img/icons/ic_help.svg" alt=""></button>

        <ng-select
          [items]="keywordsBuffer"
          [virtualScroll]="true"
          [loading]="loadingKeywords"
          [multiple]="true"
          [addTag]="addCustomItem"
          bindLabel="value"
          id="keywords"
          [typeahead]="keywordsInput$"
          (scrollToEnd)="fetchMoreKeywords(keywords.filterValue)"
          formControlName="keywords"
          #keywords
        ></ng-select>
      </div>

      <div class="form-row">
        <div class="form-group col-sm-6 col-md-4">
          <label for="learningResourceType">{{ 'forms.educationalResource.basicDetails.learningResourceType.label' | translate }}*</label>

          <button
            type="button"
            class="btn btn-link"
            [tooltip]="'forms.educationalResource.basicDetails.learningResourceType.tooltip' | translate"
          ><img src="assets/img/icons/ic_help.svg" alt=""></button>

          <ng-select
            [items]="learningResourceTypes$"
            [multiple]="true"
            [closeOnSelect]="false"
            bindLabel="value"
            id="learningResourceType"
            formControlName="learningResourceType"
          ></ng-select>
        </div>

        <div class="form-group col-sm-6 col-md-4">
          <label for="educationalRoles">{{ 'forms.educationalResource.basicDetails.educationalRoles.label' | translate }}</label>

          <button
            type="button"
            class="btn btn-link"
            [tooltip]="'forms.educationalResource.basicDetails.educationalRoles.tooltip' | translate"
          ><img src="assets/img/icons/ic_help.svg" alt=""></button>

          <ng-select
            [items]="educationalRoles$"
            [multiple]="true"
            bindLabel="value"
            id="educationalRoles"
            formControlName="educationalRoles"
          ></ng-select>
        </div>

        <div class="form-group col-sm-6 col-md-4">
          <label for="educationalUse">{{ 'forms.educationalResource.basicDetails.educationalUse.label' | translate }}</label>

          <button
            type="button"
            class="btn btn-link"
            [tooltip]="'forms.educationalResource.basicDetails.educationalUse.tooltip' | translate"
          ><img src="assets/img/icons/ic_help.svg" alt=""></button>

          <ng-select
            [items]="educationalUse$"
            [multiple]="true"
            bindLabel="value"
            id="educationalUse"
            formControlName="educationalUse"
          ></ng-select>
        </div>
      </div>

      <div class="form-group" formGroupName="description">
        <label for="description">{{ 'forms.educationalResource.basicDetails.description.label' | translate }}</label>

        <button
          type="button"
          class="btn btn-link"
          [tooltip]="'forms.educationalResource.basicDetails.description.tooltip' | translate"
        ><img src="assets/img/icons/ic_help.svg" alt=""></button>

        <div class="form-row">
          <div class="col-sm">
            <textarea
              class="form-control"
              id="description"
              rows="10"
              formControlName="fi"
            ></textarea>
          </div>

          <div class="col-auto">
            <button type="button" class="btn btn-gray" (click)="openModal(langVersions)">{{ 'forms.common.translations.label' | translate }}</button>

            <button
              type="button"
              class="btn btn-link"
              [tooltip]="'forms.common.translations.tooltip' | translate"
            ><img src="assets/img/icons/ic_help.svg" alt=""></button>
          </div>
        </div>

        <ng-template #langVersions>
          <div class="modal-header">
            <h5 class="modal-title">{{ 'forms.educationalResource.basicDetails.description.modal.title' | translate }}</h5>

            <button type="button" class="close" [attr.aria-label]="'forms.common.close' | translate" (click)="modalRef.hide()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="modal-body">
            <h4>{{ 'forms.educationalResource.basicDetails.description.modal.subtitle' | translate }}</h4>

            <div class="form-group">
              <label for="descriptionEn">{{ 'forms.educationalResource.basicDetails.description.modal.en' | translate }}</label>

              <textarea
                class="form-control"
                id="descriptionEn"
                rows="10"
                formControlName="en"
              ></textarea>
            </div>

            <div class="form-group">
              <label for="descriptionSv">{{ 'forms.educationalResource.basicDetails.description.modal.sv' | translate }}</label>

              <textarea
                class="form-control"
                id="descriptionSv"
                rows="10"
                formControlName="sv"
              ></textarea>
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-gray" [attr.aria-label]="'forms.common.cancel' | translate" (click)="modalRef.hide()">{{ 'forms.common.cancel' | translate }}</button>
            <button type="button" class="btn btn-blue" (click)="modalRef.hide()">{{ 'forms.common.saveChanges' | translate }}</button>
          </div>
        </ng-template>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <button
        type="button"
        class="btn btn-gray"
        (click)="previousTab()"
      >{{ 'forms.common.previous' | translate }}</button>
    </div>

    <div class="col-auto">
      <button
        type="reset"
        class="btn btn-cancel"
        (click)="resetForm()"
      >{{ 'forms.common.abort' | translate }}</button>
    </div>

    <div class="col-auto">
      <button
        type="submit"
        class="btn btn-blue"
        [disabled]="basicDetailsForm.invalid"
      >{{ 'forms.common.next' | translate }}</button>
    </div>
  </div>
</form>
