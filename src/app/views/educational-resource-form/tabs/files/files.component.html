<alert type="info" dismissible="true">
  Tervetuloa lisäämään materiaalia palveluun. Anna halutessasi materiaalille myös englannin- ja ruotsinkielinen nimi. Mikäli sinulla on samasta materiaalista eri kieliversioita niin voit lisätä ne erikseen palveluun. Samassa materiaalissa voi olla useita tiedostoja, jotka voit lisätä materiaaliin tässä näkymässä 'Lisää tiedosto' -painikkeella.
</alert>

<form [formGroup]="fileUploadForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <div class="form-row align-items-end">
      <div class="col" formGroupName="name">
        <label for="name-fi">{{ 'forms.educationalResource.basicDetails.materialName' | translate }}*</label>

        <button
          type="button"
          class="btn btn-link"
          tooltip="Oppimateriaalin nimi."
        >(?)</button>

        <input
          type="text"
          class="form-control"
          id="name-fi"
          placeholder="Oppimateriaalin nimi"
          formControlName="fi"
          required
        >
      </div>

      <div class="col-auto">
        <button type="button" class="btn btn-gray" (click)="openModal(nameI18n)">Kieliversiot</button>
      </div>

      <ng-template #nameI18n>
        <div class="modal-header">
          <h5 class="modal-title">Kieliversiot: Oppimateriaalin nimi</h5>

          <button type="button" class="close" aria-label="Sulje" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <h4>Kieliversioiden lisääminen</h4>

          <div class="form-group">
            <label for="lang">Valitse kieli</label>

            <select
              class="form-control"
              id="lang"
              (change)="selectedLang = selectLang.value"
              #selectLang
            >
              <option value="en">englanti</option>
              <option value="sv">ruotsi</option>
            </select>
          </div>

          <ng-container *ngIf="selectedLang === 'en'">
            <div class="form-group" formGroupName="name">
              <label for="name-en">{{ 'forms.educationalResource.basicDetails.materialName' | translate }}*</label>

              <input
                type="text"
                class="form-control"
                id="name-en"
                placeholder="Oppimateriaalin nimi"
                formControlName="en"
              >
            </div>
          </ng-container>

          <ng-container *ngIf="selectedLang === 'sv'">
            <div class="form-group" formGroupName="name">
              <label for="name-sv">{{ 'forms.educationalResource.basicDetails.materialName' | translate }}*</label>

              <input
                type="text"
                class="form-control"
                id="name-sv"
                placeholder="Oppimateriaalin nimi"
                formControlName="sv"
              >
            </div>
          </ng-container>
        </div>
      </ng-template>
    </div>
  </div>

  <ng-container *ngFor="let file of files.controls; let i = index;">
    <div class="form-group" formArrayName="files">
      <ng-container [formGroupName]="i">
        <h4>{{ i + 1 }}. tiedosto</h4>

        <div class="form-row align-items-end mb-2">
          <div class="col">
            <label for="{{ 'file' + i }}">{{ 'forms.educationalResource.basicDetails.file' | translate }}*</label>

            <div class="custom-file">
              <input
                type="file"
                class="custom-file-input"
                id="{{ 'file' + i }}"
                formControlName="file"
                required
              >
              <span class="custom-file-label">{{ files.controls[i].controls.file.value || 'Valitse tiedosto' }}</span>
            </div>
          </div>

          <div class="col-auto">tai</div>

          <div class="col">
            <label for="{{ 'link' + i }}">{{ 'forms.educationalResource.basicDetails.link' | translate }}*</label>

            <input
              type="text"
              class="form-control"
              id="{{ 'link' + i }}"
              placeholder="https://"
              formControlName="link"
            >
          </div>

          <div class="col-2">
            <label for="{{ 'language' + i }}">{{ 'forms.educationalResource.basicDetails.language' | translate }}*</label>

            <button
              type="button"
              class="btn btn-link"
              tooltip="Valitse millä kielellä oppimateriaalisi tai tämä osa oppimateriaaliasi on tarkoitettu opiskeltavaksi. Mikäli olet tehnyt oppimateriaalistasi käännöksen toiselle kielelle, voit lisätä tiedostot tässä samassa kohtaa ja merkata niiden opiskelukielen tähän."
            >(?)</button>

            <ng-select
              [items]="languages$ | async"
              bindLabel="value"
              id="{{ 'language' + i }}"
              placeholder="Valitse kieli"
              formControlName="language"
            ></ng-select>
          </div>
        </div>

        <div class="form-row align-items-end">
          <div class="col">
            <label for="{{ 'displayName' + i }}">{{ 'forms.educationalResource.basicDetails.displayName' | translate }}*</label>

            <button
              type="button"
              class="btn btn-link"
              tooltip="Nimi jonka haluat muiden näkevän tästä tiedostosta. Esimerkiksi Luontoetiikan luentotallenne tai Luontoetiikan diat. Mikäli oppimateriaalisi koostuu useasta tiedostosta, tiedosto valitaan käytettäväksi klikkammalla tiedoston nimeä. Nimen onkin hyvä olla ytimekäs ja selkeä."
            >(?)</button>

            <input
              type="text"
              class="form-control"
              id="{{ 'displayName' + i }}"
              placeholder="Ei valittua tiedostoa"
              formControlName="displayName"
              required
            >
          </div>

          <div class="col-auto">
            <button type="button" class="btn btn-gray">Kieliversiot</button>
          </div>
        </div>
      </ng-container>
    </div>
  </ng-container>

  <div class="form-group">
    <button type="button" class="btn btn-gray" (click)="addFile()">Lisää tiedosto</button>
  </div>

  <div class="row justify-content-end">
    <div class="col-auto">
      <button
        type="reset"
        class="btn btn-cancel"
      >{{ 'forms.common.abort' | translate }}</button>
    </div>

    <div class="col-auto">
      <button
        type="submit"
        class="btn btn-blue"
        [disabled]="fileUploadForm.invalid"
      >{{ 'forms.common.next' | translate }}</button>
    </div>
  </div>
</form>
